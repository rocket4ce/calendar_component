<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Calendar Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .example-section {
            margin-bottom: 3rem;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            border-radius: 8px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .event-info {
            margin: 1rem 0;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 4px;
        }

        .callback-demo {
            margin: 1rem 0;
            padding: 1rem;
            background: #e8f4fd;
            border-left: 4px solid #1976d2;
        }
    </style>
</head>
<body>
    <h1>Static Calendar Examples</h1>
    <p>This demonstrates the improved callback handling for static calendars.</p>

    <div class="example-section">
        <h2>Example 1: Global Function References (Recommended)</h2>
        <p>Clean, maintainable callbacks referenced by name.</p>

        <!-- This would be generated by Phoenix template -->
        <div id="calendar-1" class="static-calendar"
             data-events='[
                 {"id": 1, "title": "Team Meeting", "start": "2025-08-15T10:00:00", "backgroundColor": "#3b82f6"},
                 {"id": 2, "title": "Project Demo", "start": "2025-08-16T14:00:00", "backgroundColor": "#10b981"}
             ]'
             data-options='{"view": "dayGridMonth", "eventClick": "CalendarCallbacks.showEventDetails", "dateClick": "CalendarCallbacks.selectDate"}'>
        </div>

        <div class="callback-demo">
            <strong>Elixir Template:</strong>
            <pre><code>&lt;.static_calendar
  id="calendar-1"
  events={@events}
  options={%{
    eventClick: "CalendarCallbacks.showEventDetails",
    dateClick: "CalendarCallbacks.selectDate"
  }}
/&gt;</code></pre>
        </div>
    </div>

    <div class="example-section">
        <h2>Example 2: Simple Function Body Strings (Limited for Security)</h2>
        <p>For simple actions only, with security restrictions to prevent code injection.</p>

        <div id="calendar-2" class="static-calendar"
             data-events='[
                 {"id": 3, "title": "Simple Event", "start": "2025-08-17T09:00:00", "backgroundColor": "#f59e0b"}
             ]'
             data-options='{"view": "dayGridMonth", "eventClick": "console.log(\"Simple event:\", info.event.title)", "dateClick": "console.log(\"Date:\", info.dateStr)"}'>
        </div>

        <div class="callback-demo">
            <strong>Elixir Template:</strong>
            <pre><code>&lt;.static_calendar
  id="calendar-2"
  events={@events}
  options={%{
    eventClick: "console.log('Event:', info.event.title)",
    dateClick: "console.log('Date:', info.dateStr)"
  }}
/&gt;</code></pre>
            <p><strong>Security Note:</strong> Function body strings are limited to 200 chars and dangerous keywords are blocked.</p>
        </div>
    </div>

    <div class="example-section">
        <h2>Example 3: Complex Logic with Global References</h2>
        <p>For complex interactions, always use global function references for security.</p>

        <div id="calendar-3" class="static-calendar"
             data-events='[
                 {"id": 4, "title": "Complex Event", "start": "2025-08-18T11:30:00", "backgroundColor": "#8b5cf6"}
             ]'
             data-options='{"view": "dayGridMonth", "eventClick": "ComplexCallbacks.handleEventClick"}'>
        </div>

        <div id="event-info" class="event-info">
            Event details will appear here when clicked.
        </div>

        <div class="callback-demo">
            <strong>Elixir Template:</strong>
            <pre><code>&lt;.static_calendar
  id="calendar-3"
  events={@events}
  options={%{
    eventClick: "ComplexCallbacks.handleEventClick"
  }}
/&gt;</code></pre>
            <strong>JavaScript:</strong>
            <pre><code>window.ComplexCallbacks = {
  handleEventClick(info) {
    document.getElementById('event-info').innerHTML =
      'Clicked: ' + info.event.title + ' at ' + info.event.start.toLocaleString();
  }
};</code></pre>
        </div>
    </div>

    <!-- Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="modal-title">Event Details</h3>
            <p id="modal-date"></p>
            <p id="modal-description"></p>
        </div>
    </div>

    <script type="module">
        // Simulate the calendar_component/static import
        console.log('Loading static calendar functionality...');

        // Global callback functions (Example 1)
        window.CalendarCallbacks = {
            showEventDetails(info) {
                const modal = document.getElementById('event-modal');
                const title = document.getElementById('modal-title');
                const date = document.getElementById('modal-date');

                title.textContent = info.event.title;
                date.textContent = 'Date: ' + info.event.start.toLocaleDateString();

                modal.style.display = 'block';

                console.log('Event details shown for:', info.event.title);
            },

            selectDate(info) {
                console.log('Date selected:', info.dateStr);
                alert('You selected: ' + info.dateStr);
            }
        };

        // Complex callback functions (Example 3)
        window.ComplexCallbacks = {
            handleEventClick(info) {
                document.getElementById('event-info').innerHTML =
                    'Clicked: ' + info.event.title + ' at ' + info.event.start.toLocaleString();
            }
        };

        // Close modal functionality
        document.querySelector('.close').addEventListener('click', function() {
            document.getElementById('event-modal').style.display = 'none';
        });

        window.addEventListener('click', function(event) {
            const modal = document.getElementById('event-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });

        console.log('âœ… Static calendar callbacks loaded successfully!');
        console.log('This demonstrates the improved callback system:');
        console.log('1. Global function references (cleanest)');
        console.log('2. Function body strings (for simple cases)');
        console.log('3. Complete function strings (for complex logic)');
    </script>
</body>
</html>
